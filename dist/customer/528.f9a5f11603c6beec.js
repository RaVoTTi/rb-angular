"use strict";(self.webpackChunkcustomer=self.webpackChunkcustomer||[]).push([[528],{5528:(I,a,i)=>{i.r(a),i.d(a,{CheckoutModule:()=>y});var n=i(6895),h=i(5467),s=i(433),p=i(7967),u=i(5698),v=i(2490),l=i(3629),d=i(9653),t=i(4650),P=i(4278),f=i(3900),g=i(529);let k=(()=>{class e{constructor(o,r){this.http=o,this.router=r,this.API_URL=l.N.API_URL}postMyPlaceOrder(o){return this.http.post(`${this.API_URL}/myorder/placeorder/${o}`,{}).pipe((0,f.w)(({url:r})=>window.location.href=r))}getMyPlaceOrder(o){return this.http.get(`${this.API_URL}/myorder/placeorder/${o}`)}patchCheckout(o,r){return this.http.patch(`${this.API_URL}/myorder/checkout/${o}`,{token:r}).toPromise()}getConfirmOrder(o){return this.http.get(`${this.API_URL}/myorder/confirm/${o}`)}}return e.\u0275fac=function(o){return new(o||e)(t.LFG(g.eN),t.LFG(h.F0))},e.\u0275prov=t.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var b=i(3248);let A=(()=>{class e{constructor(o,r,m,U,T,L,O){this.formBuilder=o,this.location=r,this.route=m,this.bookBaseService=U,this.checkoutService=T,this.router=L,this.store=O,this.RAW_URL=l.N.RAW_URL,this.couponForm=new s.NI(""),this.checkoutComplete=!1,this.init=!1}ngOnInit(){this._getBook()}back(){this.location.back()}_initForm(o,r){this.orderForm=this.formBuilder.group({price:[o,[s.kI.required,s.kI.min(o),s.kI.max(r)]]})}onSubmit(){this.checkoutService.postMyPlaceOrder(this.id).subscribe(o=>{})}onSubmitCoupon(){this.couponForm.markAsTouched()}_getBook(){this.route.params.pipe((0,u.q)(1)).subscribe(o=>{o.id&&(this.id=o.id,this.store.pipe((0,d.Ys)((0,v.NK)(this.id)),(0,u.q)(1)).subscribe(r=>{r&&(this.book=r,this.minPrice=this.book.minPrice,this.maxPrice=this.book.maxPrice,this.price=this.book.minPrice,this._initForm(this.minPrice,this.maxPrice),this.init=!0)}))})}validateCamp(o){return this.orderForm.controls[o].errors&&this.orderForm.controls[o].touched}validateCoupon(){return this.couponForm.touched}getPrice(){return this.orderForm.get("price")?.value}getPriceFormated(){!this.getPrice()||this.orderForm.get("price")?.value<this.minPrice?(this.price=this.minPrice,this.orderForm.patchValue({price:this.minPrice})):this.orderForm.get("price")?.value>this.maxPrice?(this.price=this.maxPrice,this.orderForm.patchValue({price:this.maxPrice})):this.price=this.getPrice()}}return e.\u0275fac=function(o){return new(o||e)(t.Y36(s.qu),t.Y36(n.Ye),t.Y36(h.gz),t.Y36(P.d),t.Y36(k),t.Y36(h.F0),t.Y36(d.yh))},e.\u0275cmp=t.Xpm({type:e,selectors:[["frontend-place-order"]],decls:36,vars:10,consts:[[1,"place-order"],[1,"container-fluid"],[1,"row"],[1,"col-12","col-sm-3"],[3,"book"],[1,"col-12","col-sm-8"],[1,"d-flex","flex-column","mt-3","mt-sm-0"],[1,"place-order-table"],[1,"table"],["scope","col"],[1,"bg-primary-light"],[1,"btn","btn-primary","mt-3",3,"click"]],template:function(o,r){1&o&&(t.TgZ(0,"section",0)(1,"div",1)(2,"div",2)(3,"div",3),t._UZ(4,"frontend-card-book",4),t.qZA(),t.TgZ(5,"div",5)(6,"div",6)(7,"div",7)(8,"table",8)(9,"thead")(10,"tr")(11,"th",9),t._uU(12,"#"),t.qZA(),t.TgZ(13,"th",9),t._uU(14,"Cost"),t.qZA()()(),t.TgZ(15,"tbody")(16,"tr")(17,"th"),t._uU(18),t.ALo(19,"titlecase"),t.qZA(),t.TgZ(20,"td"),t._uU(21),t.ALo(22,"currency"),t.qZA()(),t.TgZ(23,"tr")(24,"th"),t._uU(25,"Delivery"),t.qZA(),t.TgZ(26,"td"),t._uU(27,"FREE"),t.qZA()(),t.TgZ(28,"tr",10)(29,"th"),t._uU(30,"Total to pay"),t.qZA(),t.TgZ(31,"td"),t._uU(32),t.ALo(33,"currency"),t.qZA()()()()(),t.TgZ(34,"button",11),t.NdJ("click",function(){return r.onSubmit()}),t._uU(35,"Continue to Payment"),t.qZA()()()()()()),2&o&&(t.xp6(4),t.Q6J("book",r.book),t.xp6(14),t.Oqu(t.lcZ(19,4,r.book.name)),t.xp6(3),t.Oqu(t.lcZ(22,6,r.price)),t.xp6(11),t.Oqu(t.lcZ(33,8,r.price)))},dependencies:[b.b,n.rS,n.H9],encapsulation:2}),e})();var Z=i(6365);const F=[{path:"placeorder/:id",component:A,resolve:{books:i(8933).K}}];let y=(()=>{class e{}return e.\u0275fac=function(o){return new(o||e)},e.\u0275mod=t.oAB({type:e}),e.\u0275inj=t.cJS({imports:[Z.BookBaseModule,n.ez,s.UX,p.As,h.Bz.forChild(F)]}),e})()}}]);