"use strict";(self.webpackChunkcustomer=self.webpackChunkcustomer||[]).push([[528],{5528:(B,a,i)=>{i.r(a),i.d(a,{CheckoutModule:()=>C});var n=i(6895),h=i(5467),c=i(433),l=i(5931),d=i(5698),u=i(28),m=i(3629),p=i(2997),t=i(4650),P=i(3900),f=i(529);let k=(()=>{class o{constructor(e,r){this.http=e,this.router=r,this.API_URL=m.N.API_URL}postMyPlaceOrder(e){return this.http.post(`${this.API_URL}/myorder/placeorder/${e}`,{}).pipe((0,P.w)(({url:r})=>window.location.href=r))}getMyPlaceOrder(e){return this.http.get(`${this.API_URL}/myorder/placeorder/${e}`)}patchCheckout(e,r){return this.http.patch(`${this.API_URL}/myorder/checkout/${e}`,{token:r}).toPromise()}getConfirmOrder(e){return this.http.get(`${this.API_URL}/myorder/confirm/${e}`)}}return o.\u0275fac=function(e){return new(e||o)(t.LFG(f.eN),t.LFG(h.F0))},o.\u0275prov=t.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"}),o})();var g=i(3248);const A=[{path:"placeorder/:id",component:(()=>{class o{constructor(e,r,v,Z,b,y,F,U){this.formBuilder=e,this.location=r,this.route=v,this.bookBaseService=Z,this.checkoutService=b,this.alertService=y,this.router=F,this.store=U,this.RAW_URL=m.N.RAW_URL,this.couponForm=new c.NI(""),this.checkoutComplete=!1,this.init=!1}ngOnInit(){this._getBook()}back(){this.location.back()}_initForm(e,r){this.orderForm=this.formBuilder.group({price:[e,[c.kI.required,c.kI.min(e),c.kI.max(r)]]})}onSubmit(){this.checkoutService.postMyPlaceOrder(this.id).subscribe(e=>{})}onSubmitCoupon(){this.couponForm.markAsTouched()}_getBook(){this.route.params.pipe((0,d.q)(1)).subscribe(e=>{e.id&&(this.id=e.id,this.store.pipe((0,p.Ys)((0,u.selectBooksById)(this.id)),(0,d.q)(1)).subscribe(r=>{r&&(this.book=r,this.minPrice=this.book.minPrice,this.maxPrice=this.book.maxPrice,this.price=this.book.minPrice,this._initForm(this.minPrice,this.maxPrice),this.init=!0)}))})}validateCamp(e){return this.orderForm.controls[e].errors&&this.orderForm.controls[e].touched}validateCoupon(){return this.couponForm.touched}getPrice(){return this.orderForm.get("price")?.value}getPriceFormated(){!this.getPrice()||this.orderForm.get("price")?.value<this.minPrice?(this.price=this.minPrice,this.orderForm.patchValue({price:this.minPrice})):this.orderForm.get("price")?.value>this.maxPrice?(this.price=this.maxPrice,this.orderForm.patchValue({price:this.maxPrice})):this.price=this.getPrice()}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(c.qu),t.Y36(n.Ye),t.Y36(h.gz),t.Y36(u.BookBaseService),t.Y36(k),t.Y36(l.c9),t.Y36(h.F0),t.Y36(p.yh))},o.\u0275cmp=t.Xpm({type:o,selectors:[["frontend-place-order"]],decls:36,vars:10,consts:[[1,"place-order"],[1,"container-fluid"],[1,"row"],[1,"col-12","col-sm-3"],[3,"book"],[1,"col-12","col-sm-8"],[1,"d-flex","flex-column","mt-3","mt-sm-0"],[1,"place-order-table"],[1,"table"],["scope","col"],[1,"bg-primary-light"],[1,"btn","btn-primary","mt-3",3,"click"]],template:function(e,r){1&e&&(t.TgZ(0,"section",0)(1,"div",1)(2,"div",2)(3,"div",3),t._UZ(4,"frontend-card-book",4),t.qZA(),t.TgZ(5,"div",5)(6,"div",6)(7,"div",7)(8,"table",8)(9,"thead")(10,"tr")(11,"th",9),t._uU(12,"#"),t.qZA(),t.TgZ(13,"th",9),t._uU(14,"Cost"),t.qZA()()(),t.TgZ(15,"tbody")(16,"tr")(17,"th"),t._uU(18),t.ALo(19,"titlecase"),t.qZA(),t.TgZ(20,"td"),t._uU(21),t.ALo(22,"currency"),t.qZA()(),t.TgZ(23,"tr")(24,"th"),t._uU(25,"Delivery"),t.qZA(),t.TgZ(26,"td"),t._uU(27,"FREE"),t.qZA()(),t.TgZ(28,"tr",10)(29,"th"),t._uU(30,"Total to pay"),t.qZA(),t.TgZ(31,"td"),t._uU(32),t.ALo(33,"currency"),t.qZA()()()()(),t.TgZ(34,"button",11),t.NdJ("click",function(){return r.onSubmit()}),t._uU(35,"Continue to Payment"),t.qZA()()()()()()),2&e&&(t.xp6(4),t.Q6J("book",r.book),t.xp6(14),t.Oqu(t.lcZ(19,4,r.book.name)),t.xp6(3),t.Oqu(t.lcZ(22,6,r.price)),t.xp6(11),t.Oqu(t.lcZ(33,8,r.price)))},dependencies:[g.b,n.rS,n.H9],encapsulation:2}),o})(),resolve:{books:u.BooksResolver}}];let C=(()=>{class o{}return o.\u0275fac=function(e){return new(e||o)},o.\u0275mod=t.oAB({type:o}),o.\u0275inj=t.cJS({imports:[u.BookBaseModule,n.ez,c.UX,l.As,h.Bz.forChild(A)]}),o})()}}]);